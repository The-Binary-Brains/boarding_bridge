<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="../public/css/owner_portal.css" />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css"
        />
        <link
            rel="icon"
            href="../public/images/favicon.png"
            type="image/icon type"
        />
        <title>Owner Portal</title>
    </head>
    <body>
        <div class="header">
            <span class="title">Boarding Bridge</span>
            <div class="profile">
                <div class="profile_info">
                    <img src="../../public/images/owner.jpg" alt="profile" />
                    <span class="user_name">Jane Doe</span>
                </div>
                <i class="fa-solid fa-gear"></i>
            </div>
        </div>
        <div class="container">
            <div class="nav">
                <div class="nav_button" id="dashboardButton">
                    <i class="fa-solid fa-gauge"></i>
                </div>
                <div class="nav_button" id="accommodationButton">
                    <i class="fa-solid fa-building"></i>
                </div>
                <div class="nav_button" id="messagesButton">
                    <i class="fa-solid fa-envelope-open-text"></i>
                </div>
                <div class="nav_button" id="profileButton">
                    <i class="fa-solid fa-user"></i>
                </div>
            </div>
            <div class="content">
                <div class="page_title">Dashboard</div>
                <div class="analitics">
                    <div class="analitics_container total">
                        <div class="icon">
                            <div class="icon_bg">
                                <i class="fa-solid fa-chart-line"></i>
                            </div>
                        </div>
                        <div class="info">
                            <div class="title">Total Views</div>
                            <div class="sub_title">124</div>
                        </div>
                    </div>
                    <div class="analitics_container properties">
                        <div class="icon">
                            <div class="icon_bg">
                                <i class="fa-solid fa-building"></i>
                            </div>
                        </div>
                        <div class="info">
                            <div class="title">Published Properties</div>
                            <div class="sub_title">5</div>
                        </div>
                    </div>
                    <div class="analitics_container approvel">
                        <div class="icon">
                            <div class="icon_bg">
                                <i class="fa-solid fa-hourglass-end"></i>
                            </div>
                        </div>
                        <div class="info">
                            <div class="title">Waiting for Approvel</div>
                            <div class="sub_title">2</div>
                        </div>
                    </div>
                </div>
                <div class="reserved_dates_container">
                    <div class="container_title">Reserved Dates</div>
                    <div class="container_line"></div>
                    <div class="calender_wrapper">
                        <div class="calendar">
                            <div class="calendar-header">
                                <button id="prev-month">❮</button>
                                <span id="month-year"></span>
                                <button id="next-month">❯</button>
                            </div>
                            <div class="calendar-body">
                                <div class="calendar-days">
                                    <div>Sun</div>
                                    <div>Mon</div>
                                    <div>Tue</div>
                                    <div>Wed</div>
                                    <div>Thu</div>
                                    <div>Fri</div>
                                    <div>Sat</div>
                                </div>
                                <div
                                    class="calendar-dates"
                                    id="calendar-dates"
                                ></div>
                            </div>
                        </div>
                        <div class="properties">
                            <div class="container_title">Property</div>
                            <div class="container_line"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <footer>
            <div class="Center">
                <div class="logo">
                    <div class="title">Boarding Bridge</div>
                    <div class="sub_title">
                        "Connecting Students with Quality Accommodations"
                    </div>
                    <p>
                        Phone : +94 01 457 8546 <br />
                        Email : support@boardingbridge.lk <br />
                        Address: 123 Campus Dr., City
                    </p>
                </div>
            </div>
            <div class="bottom">
                <div class="bottom_line"></div>
                <span class="rights"
                    >© 2024 BoardingBridge. All rights reserved.</span
                >
            </div>
        </footer>
    </body>
    <script>
        // Select the buttons
        const dashboardButton = document.getElementById("dashboardButton");
        const accommodationButton = document.getElementById(
            "accommodationButton"
        );
        const messagesButton = document.getElementById("messagesButton");
        const profileButton = document.getElementById("profileButton");

        // Add event listeners for each button
        dashboardButton.addEventListener("click", () => {
            changeSelectedButton(dashboardButton);
            loadContent("http://localhost:5000/dashboard/");
        });

        accommodationButton.addEventListener("click", () => {
            changeSelectedButton(accommodationButton);
        });

        messagesButton.addEventListener("click", () => {
            changeSelectedButton(messagesButton);
        });

        profileButton.addEventListener("click", () => {
            changeSelectedButton(profileButton);
        });

        // Function to change the selected button's color
        function changeSelectedButton(selectedButton) {
            // Remove 'selected' class from all buttons
            const buttons = document.querySelectorAll(".nav_button");
            buttons.forEach((button) => {
                button.classList.remove("selected");
            });

            // Add 'selected' class to the clicked button
            selectedButton.classList.add("selected");
        }

        // Function to load content dynamically based on the button clicked
        function loadContent(url) {
            fetch(url)
                .then((response) => response.text())
                .then((data) => {
                    const contentDiv = document.querySelector(".content");
                    contentDiv.innerHTML = data; // Insert the fetched content into the content div
                    const scripts = contentElement.querySelectorAll("script");
                    scripts.forEach((script) => {
                        const newScript = document.createElement("script");
                        newScript.text = script.textContent || script.innerText;
                        document.body.appendChild(newScript); // Append the new script to execute
                    });
                    if (typeof renderCalendar === 'function') {
                        renderCalendar();  // Call the function after script execution
        }
                })
                .catch((error) => {
                    console.error("Error loading content:", error);
                });
        }

        const monthYearElement = document.getElementById("month-year");
        const calendarDatesElement = document.getElementById("calendar-dates");
        const prevMonthButton = document.getElementById("prev-month");
        const nextMonthButton = document.getElementById("next-month");

        let currentDate = new Date();

        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();

            monthYearElement.textContent = currentDate.toLocaleDateString(
                "en-US",
                {
                    year: "numeric",
                    month: "long",
                }
            );

            calendarDatesElement.innerHTML = "";

            const firstDayOfMonth = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            for (let i = 0; i < firstDayOfMonth; i++) {
                const emptyCell = document.createElement("div");
                calendarDatesElement.appendChild(emptyCell);
            }

            for (let day = 1; day <= daysInMonth; day++) {
                const dateButton = document.createElement("button");
                dateButton.textContent = day;

                if (
                    day === new Date().getDate() &&
                    month === new Date().getMonth() &&
                    year === new Date().getFullYear()
                ) {
                    dateButton.classList.add("current-date");
                }

                calendarDatesElement.appendChild(dateButton);
            }
        }

        prevMonthButton.addEventListener("click", () => {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        });

        nextMonthButton.addEventListener("click", () => {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        });

        renderCalendar();
    </script>
</html>
